{% extends "base.html" %}

{% block content %}
    <h2>ğŸ‘¨â€âš•ï¸ Dashboard Medico</h2>

    <!-- Form di ricerca farmaco -->
    <form action="{{ url_for('search') }}" method="POST" class="search-form">
        <input type="text" name="query" placeholder="Cerca un farmaco..." required>
        <button type="submit">ğŸ” Cerca</button>
    </form>

    <!-- Link per aggiungere nuovi pazienti e farmaci -->
    <div class="dashboard-actions">
        <a href="{{ url_for('aggiungi_paziente') }}" class="btn">â• Aggiungi Paziente</a>
        <a href="{{ url_for('aggiungi_farmaco') }}" class="btn">â• Registra Farmaco</a>
    </div>

    <h3>ğŸ“‹ Lista Pazienti</h3>

    {% if pazienti %}
        <table class="patients-table">
            <thead>
                <tr>
                    <th>ğŸ‘¤ Nome</th>
                    <th>ğŸ‚ Data di Nascita</th>
                    <th>âš§ï¸ Sesso</th>
                    <th>ğŸ“‘ Note Mediche</th>
                    <th>ğŸ’Š Farmaci</th>
                    <th>ğŸ›  Azioni</th>
                </tr>
            </thead>
            <tbody>
                {% for paziente in pazienti %}
                <tr>
                    <td>{{ paziente.nome }} {{ paziente.cognome }}</td>
                    <td>{{ paziente.data_nascita }}</td>
                    <td>{{ paziente.sesso }}</td>
                    <td>{{ paziente.note_mediche if paziente.note_mediche else 'Nessuna' }}</td>
                    <td>
                        {% if paziente.farmaci %}
                            <ul>
                                {% for farmaco in paziente.farmaci %}
                                    <li>{{ farmaco.nome }} ({{ farmaco.dose }})</li>
                                {% endfor %}
                            </ul>
                        {% else %}
                            âŒ Nessun farmaco assegnato
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ url_for('aggiungi_farmaco') }}" class="btn-action">â• Aggiungi Farmaco</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>âŒ Nessun paziente registrato.</p>
    {% endif %}

{% endblock %}
